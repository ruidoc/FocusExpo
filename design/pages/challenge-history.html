<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>æŒ‘æˆ˜å†å²</title>
  <link rel="stylesheet" href="../styles/tokens.css">
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
      background: var(--bg-grouped);
      height: 100vh;
      overflow: hidden;
      margin: 0;
    }
    
    .container {
      height: 100%;
      display: flex;
      flex-direction: column;
      padding-top: var(--safe-top);
      padding-bottom: var(--safe-bottom);
    }
    
    /* iOS Style Header */
    .ios-header {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 44px;
      background: var(--bg-tertiary);
      border-bottom: 1px solid var(--separator);
      position: relative;
    }
    
    .back-btn {
      position: absolute;
      left: 16px;
      background: none;
      border: none;
      font-size: 20px;
      color: var(--primary);
      cursor: pointer;
    }
    
    .header-title {
      font-size: 17px;
      font-weight: 600;
      color: var(--text-primary);
      text-align: center;
    }
    
    /* Content Area */
    .content {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-4);
    }
    
    /* Stats Overview */
    .stats-overview {
      background: linear-gradient(135deg, var(--primary) 0%, #5AC8FA 100%);
      border-radius: var(--radius-xl);
      padding: var(--space-6);
      margin-bottom: var(--space-6);
      color: white;
      position: relative;
      overflow: hidden;
    }
    
    .stats-overview::before {
      content: '';
      position: absolute;
      top: -30%;
      right: -15%;
      width: 150px;
      height: 150px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      backdrop-filter: blur(20px);
    }
    
    .stats-title {
      font-size: var(--font-size-lg);
      font-weight: 600;
      margin-bottom: var(--space-4);
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--space-4);
    }
    
    .stat-item {
      text-align: center;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-lg);
      padding: var(--space-4);
    }
    
    .stat-value {
      font-size: var(--font-size-2xl);
      font-weight: 700;
      margin-bottom: var(--space-1);
    }
    
    .stat-label {
      font-size: var(--font-size-sm);
      opacity: 0.9;
    }
    
    /* Filter Tabs */
    .filter-tabs {
      display: flex;
      background: var(--bg-primary);
      border-radius: var(--radius-lg);
      padding: var(--space-1);
      margin-bottom: var(--space-6);
      box-shadow: var(--shadow-card);
    }
    
    .filter-tab {
      flex: 1;
      background: none;
      border: none;
      padding: var(--space-3);
      border-radius: var(--radius-md);
      font-size: var(--font-size-sm);
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .filter-tab.active {
      background: var(--primary);
      color: white;
      font-weight: 600;
    }
    
    /* Challenge List */
    .challenge-list {
      display: flex;
      flex-direction: column;
      gap: var(--space-4);
    }
    
    .challenge-card {
      background: var(--bg-primary);
      border-radius: var(--radius-lg);
      padding: var(--space-5);
      box-shadow: var(--shadow-card);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .challenge-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      background: var(--success);
    }
    
    .challenge-card.failed::before {
      background: var(--error);
    }
    
    .challenge-card.ongoing::before {
      background: var(--warning);
    }
    
    .challenge-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-elevated);
    }
    
    .challenge-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: var(--space-3);
    }
    
    .challenge-info {
      flex: 1;
    }
    
    .challenge-title {
      font-size: var(--font-size-md);
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: var(--space-1);
    }
    
    .challenge-subtitle {
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
      margin-bottom: var(--space-2);
    }
    
    .challenge-date {
      font-size: var(--font-size-xs);
      color: var(--text-tertiary);
    }
    
    .challenge-status {
      display: flex;
      align-items: center;
      gap: var(--space-1);
      padding: var(--space-1) var(--space-3);
      border-radius: var(--radius-full);
      font-size: var(--font-size-xs);
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .challenge-status.completed {
      background: var(--success-light);
      color: var(--success);
    }
    
    .challenge-status.failed {
      background: var(--error-light);
      color: var(--error);
    }
    
    .challenge-status.ongoing {
      background: var(--warning-light);
      color: var(--warning);
    }
    
    .challenge-progress {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      margin-top: var(--space-3);
    }
    
    .progress-bar {
      flex: 1;
      height: 6px;
      background: var(--bg-secondary);
      border-radius: var(--radius-full);
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      border-radius: var(--radius-full);
      transition: width 0.3s ease;
    }
    
    .progress-fill.completed {
      background: var(--success);
      width: 100%;
    }
    
    .progress-fill.failed {
      background: var(--error);
      width: 67%;
    }
    
    .progress-fill.ongoing {
      background: var(--warning);
      width: 33%;
    }
    
    .progress-text {
      font-size: var(--font-size-xs);
      color: var(--text-secondary);
      white-space: nowrap;
    }
    
    .challenge-reward {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: var(--space-3);
      padding-top: var(--space-3);
      border-top: 1px solid var(--separator);
    }
    
    .reward-info {
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }
    
    .reward-amount {
      font-size: var(--font-size-sm);
      font-weight: 600;
      color: var(--primary);
    }
    
    .reward-label {
      font-size: var(--font-size-xs);
      color: var(--text-secondary);
    }
    
    .challenge-action {
      background: none;
      border: 1px solid var(--separator);
      border-radius: var(--radius-md);
      padding: var(--space-1) var(--space-3);
      font-size: var(--font-size-xs);
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .challenge-action:hover {
      border-color: var(--primary);
      color: var(--primary);
    }
    
    /* Empty State */
    .empty-state {
      text-align: center;
      padding: var(--space-12) var(--space-4);
      color: var(--text-secondary);
    }
    
    .empty-icon {
      font-size: 64px;
      margin-bottom: var(--space-4);
      opacity: 0.5;
    }
    
    .empty-title {
      font-size: var(--font-size-lg);
      font-weight: 600;
      margin-bottom: var(--space-2);
    }
    
    .empty-subtitle {
      font-size: var(--font-size-sm);
      line-height: 1.5;
    }
    
    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .stats-overview,
    .filter-tabs,
    .challenge-card {
      animation: fadeInUp 0.6s ease-out;
    }
    
    .filter-tabs {
      animation-delay: 0.1s;
    }
    
    .challenge-card:nth-child(1) {
      animation-delay: 0.2s;
    }
    
    .challenge-card:nth-child(2) {
      animation-delay: 0.3s;
    }
    
    .challenge-card:nth-child(3) {
      animation-delay: 0.4s;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="ios-header">
      <button class="back-btn">
        <ion-icon name="chevron-back-outline"></ion-icon>
      </button>
      <div class="header-title">æŒ‘æˆ˜å†å²</div>
    </div>
    
    <div class="content">
      <!-- Stats Overview -->
      <div class="stats-overview">
        <div class="stats-title">
          <ion-icon name="trophy"></ion-icon>
          æˆ‘çš„æŒ‘æˆ˜æˆå°±
        </div>
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-value">12</div>
            <div class="stat-label">å·²å®Œæˆ</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">3</div>
            <div class="stat-label">è¿›è¡Œä¸­</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">85%</div>
            <div class="stat-label">æˆåŠŸç‡</div>
          </div>
        </div>
      </div>
      
      <!-- Filter Tabs -->
      <div class="filter-tabs">
        <button class="filter-tab active" data-filter="all">å…¨éƒ¨</button>
        <button class="filter-tab" data-filter="completed">å·²å®Œæˆ</button>
        <button class="filter-tab" data-filter="ongoing">è¿›è¡Œä¸­</button>
        <button class="filter-tab" data-filter="failed">å·²å¤±è´¥</button>
      </div>
      
      <!-- Challenge List -->
      <div class="challenge-list">
        <!-- Ongoing Challenge -->
        <div class="challenge-card ongoing" data-category="ongoing">
          <div class="challenge-header">
            <div class="challenge-info">
              <div class="challenge-title">å·¥ä½œæ—¥ä¸“æ³¨æŒ‘æˆ˜</div>
              <div class="challenge-subtitle">è¿ç»­3ä¸ªå·¥ä½œæ—¥å®Œæˆâ‰¥30åˆ†é’Ÿä¸“æ³¨</div>
              <div class="challenge-date">2024å¹´1æœˆ15æ—¥ å¼€å§‹</div>
            </div>
            <div class="challenge-status ongoing">
              <ion-icon name="time"></ion-icon>
              è¿›è¡Œä¸­
            </div>
          </div>
          <div class="challenge-progress">
            <div class="progress-bar">
              <div class="progress-fill ongoing"></div>
            </div>
            <div class="progress-text">ç¬¬ 1/3 å¤©</div>
          </div>
          <div class="challenge-reward">
            <div class="reward-info">
              <ion-icon name="diamond"></ion-icon>
              <span class="reward-amount">+50 è‡ªå¾‹å¸</span>
              <span class="reward-label">å®Œæˆå¥–åŠ±</span>
            </div>
            <button class="challenge-action">ç»§ç»­æŒ‘æˆ˜</button>
          </div>
        </div>
        
        <!-- Completed Challenge -->
        <div class="challenge-card completed" data-category="completed">
          <div class="challenge-header">
            <div class="challenge-info">
              <div class="challenge-title">å‘¨æœ«æ·±åº¦ä¸“æ³¨</div>
              <div class="challenge-subtitle">å‘¨æœ«2å¤©å„å®Œæˆâ‰¥60åˆ†é’Ÿä¸“æ³¨</div>
              <div class="challenge-date">2024å¹´1æœˆ8æ—¥ - 1æœˆ9æ—¥</div>
            </div>
            <div class="challenge-status completed">
              <ion-icon name="checkmark-circle"></ion-icon>
              å·²å®Œæˆ
            </div>
          </div>
          <div class="challenge-progress">
            <div class="progress-bar">
              <div class="progress-fill completed"></div>
            </div>
            <div class="progress-text">2/2 å¤©å®Œæˆ</div>
          </div>
          <div class="challenge-reward">
            <div class="reward-info">
              <ion-icon name="diamond"></ion-icon>
              <span class="reward-amount">+30 è‡ªå¾‹å¸</span>
              <span class="reward-label">å·²è·å¾—</span>
            </div>
            <button class="challenge-action">æŸ¥çœ‹è¯¦æƒ…</button>
          </div>
        </div>
        
        <!-- Failed Challenge -->
        <div class="challenge-card failed" data-category="failed">
          <div class="challenge-header">
            <div class="challenge-info">
              <div class="challenge-title">æ—©èµ·ä¸“æ³¨æŒ‘æˆ˜</div>
              <div class="challenge-subtitle">è¿ç»­5å¤©æ—©ä¸Š7:00-8:00ä¸“æ³¨</div>
              <div class="challenge-date">2024å¹´1æœˆ1æ—¥ - 1æœˆ3æ—¥</div>
            </div>
            <div class="challenge-status failed">
              <ion-icon name="close-circle"></ion-icon>
              å·²å¤±è´¥
            </div>
          </div>
          <div class="challenge-progress">
            <div class="progress-bar">
              <div class="progress-fill failed"></div>
            </div>
            <div class="progress-text">2/5 å¤©å®Œæˆ</div>
          </div>
          <div class="challenge-reward">
            <div class="reward-info">
              <ion-icon name="remove-circle"></ion-icon>
              <span class="reward-amount">-20 è‡ªå¾‹å¸</span>
              <span class="reward-label">å¤±è´¥æ‰£é™¤</span>
            </div>
            <button class="challenge-action">é‡æ–°æŒ‘æˆ˜</button>
          </div>
        </div>
        
        <!-- Completed Challenge 2 -->
        <div class="challenge-card completed" data-category="completed">
          <div class="challenge-header">
            <div class="challenge-info">
              <div class="challenge-title">ç•ªèŒ„å·¥ä½œæ³•æŒ‘æˆ˜</div>
              <div class="challenge-subtitle">ä¸€å¤©å†…å®Œæˆ8ä¸ª25åˆ†é’Ÿç•ªèŒ„é’Ÿ</div>
              <div class="challenge-date">2023å¹´12æœˆ28æ—¥</div>
            </div>
            <div class="challenge-status completed">
              <ion-icon name="checkmark-circle"></ion-icon>
              å·²å®Œæˆ
            </div>
          </div>
          <div class="challenge-progress">
            <div class="progress-bar">
              <div class="progress-fill completed"></div>
            </div>
            <div class="progress-text">8/8 ä¸ªç•ªèŒ„é’Ÿ</div>
          </div>
          <div class="challenge-reward">
            <div class="reward-info">
              <ion-icon name="diamond"></ion-icon>
              <span class="reward-amount">+25 è‡ªå¾‹å¸</span>
              <span class="reward-label">å·²è·å¾—</span>
            </div>
            <button class="challenge-action">æŸ¥çœ‹è¯¦æƒ…</button>
          </div>
        </div>
      </div>
      
      <!-- Empty State (hidden by default) -->
      <div class="empty-state" style="display: none;">
        <div class="empty-icon">ğŸ†</div>
        <div class="empty-title">æš‚æ— æŒ‘æˆ˜è®°å½•</div>
        <div class="empty-subtitle">å‚ä¸æŒ‘æˆ˜ï¼Œè·å¾—å¥–åŠ±ï¼Œ<br>è®©ä¸“æ³¨å˜å¾—æ›´æœ‰è¶£ï¼</div>
      </div>
    </div>
  </div>
  
  <script>
    // Listen for theme changes from parent window
    window.addEventListener('message', (event) => {
      if (event.data.type === 'theme-change') {
        document.documentElement.setAttribute('data-theme', event.data.theme);
      }
    });
    
    // Initialize theme from parent or localStorage
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    
    // Filter functionality
    const filterTabs = document.querySelectorAll('.filter-tab');
    const challengeCards = document.querySelectorAll('.challenge-card');
    const challengeList = document.querySelector('.challenge-list');
    const emptyState = document.querySelector('.empty-state');
    
    filterTabs.forEach(tab => {
      tab.addEventListener('click', () => {
        // Update active tab
        filterTabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        
        // Filter challenges
        const filter = tab.dataset.filter;
        let visibleCount = 0;
        
        challengeCards.forEach(card => {
          if (filter === 'all' || card.dataset.category === filter) {
            card.style.display = 'block';
            visibleCount++;
          } else {
            card.style.display = 'none';
          }
        });
        
        // Show/hide empty state
        if (visibleCount === 0) {
          challengeList.style.display = 'none';
          emptyState.style.display = 'block';
        } else {
          challengeList.style.display = 'flex';
          emptyState.style.display = 'none';
        }
      });
    });
    
    // Challenge action buttons
    document.querySelectorAll('.challenge-action').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        const action = btn.textContent.trim();
        
        switch (action) {
          case 'ç»§ç»­æŒ‘æˆ˜':
            // Navigate to challenge detail
            console.log('Continue challenge');
            break;
          case 'æŸ¥çœ‹è¯¦æƒ…':
            // Show challenge details
            console.log('View details');
            break;
          case 'é‡æ–°æŒ‘æˆ˜':
            // Restart challenge
            console.log('Restart challenge');
            break;
        }
      });
    });
  </script>
</body>
</html>
