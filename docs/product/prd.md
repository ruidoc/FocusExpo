# FocusOne 产品需求文档（PRD）

> 自动化的应用屏蔽工具，用自动化 + 强制力替代意志力。

---

## 1. 产品概述

### 1.1 产品定位

**FocusOne** 是一款自动化的应用屏蔽工具，通过 iOS 系统级能力（Screen Time API）实现定时自动屏蔽分心应用。

**核心差异化：**

1. **物理阻断，不是提醒**
   - 使用 iOS Family Controls 系统级 API
   - 屏蔽期间应用真正无法打开
   - 不同于提醒类 App（Forest、番茄钟等）

2. **自动执行，不需意志力**
   - 设置一次专注计划，每天定时自动执行
   - 无需每次手动决策"要不要开始专注"
   - 将意志力投入转化为一次性配置

**一句话定位：**

用自动化 + 强制力，替代意志力的专注工具。

### 1.2 目标用户

| 用户群体   | 特征                        | 核心痛点                                             |
| ---------- | --------------------------- | ---------------------------------------------------- |
| 学生群体   | 16-25岁，需要备考或完成作业 | 知道该专注，但总在"要不要开始"上纠结，缺乏启动意志力 |
| 职场人士   | 25-40岁，知识工作者         | 每天需要专注的时段是固定的，但总忘记手动启动屏蔽     |
| 自由职业者 | 需要高度自律的远程工作者    | 缺乏外部约束，需要强制执行的工具                     |
| 自我提升者 | 对个人成长有追求的用户      | 想建立专注习惯，但依赖手动启动太消耗意志力           |

**用户共同特征：**

- 知道自己需要专注
- 缺乏意志力每次手动开启
- 总在"要不要开始专注"上纠结
- 需要一个强制执行的外部约束

### 1.3 核心价值主张

1. **自动化执行 → 无需意志力**
   - 设置一次专注计划，每天定时自动执行
   - 无需每次手动决策"要不要开始"
   - 将意志力消耗转化为一次性配置

2. **系统级强制 → 物理阻断**
   - 使用 iOS Family Controls API，真正阻止应用打开
   - 不是提醒，是屏蔽期间应用无法启动
   - 用户无法绕过（除非主动退出计划）

3. **灵活计划 → 适配不同场景**
   - 支持一次性、定时、周期重复等多种模式
   - 工作日自动屏蔽、周末自由安排
   - 不同时段屏蔽不同应用

4. **数据洞察 → 持续改进**
   - 量化专注时长、成功率
   - 识别最容易分心的时段和应用
   - 基于数据优化计划

---

## 2. 功能模块

### 2.1 专注计划（核心功能）

专注计划是产品的核心功能，尤其是**定时计划**——它是"自动执行"价值的载体，用户设置一次后自动生效，无需手动启动。

#### 2.1.1 计划类型

产品提供 **2 种计划类型**：

| 类型           | 说明                                     | 使用场景                                                    | 价值定位                                                        |
| -------------- | ---------------------------------------- | ----------------------------------------------------------- | --------------------------------------------------------------- |
| **定时计划**   | 指定开始和结束时间，可设置重复规则       | 固定时段专注，如"每天 9:00-12:00"或"周一到周五 14:00-17:00" | ⭐️ **核心价值**：设置一次，自动执行，体现"无需意志力"的产品价值 |
| **一次性计划** | 立即开始，指定时长后结束，不需要创建计划 | 1. onboarding 快速体验<br>2. 日常临时专注需求               | **便捷入口**：不想创建计划时的快速启动方式                      |

**设计说明：**

1. **定时计划的重复规则**
   - 不重复（仅执行一次）
   - 每天
   - 工作日（周一至周五）
   - 周末（周六、周日）
   - 自定义（选择特定星期几）

   > 注：重复规则是定时计划的属性，不是单独的计划类型

2. **一次性计划 vs 定时计划**
   - **产品策略**：建议用户创建定时计划（核心价值）
   - **用户现实**：临时专注需求真实存在
   - **设计平衡**：提供一次性计划作为便捷入口，两者结合覆盖不同场景

#### 2.1.2 计划属性

```typescript
interface Plan {
  id: string; // 唯一标识
  name: string; // 计划名称
  type: 'once' | 'scheduled'; // 计划类型：一次性 | 定时
  start_min: number; // 开始时间（当天分钟数）
  end_min: number; // 结束时间（当天分钟数）
  repeat: number[]; // 重复规则（仅定时计划）：0=周日 ... 6=周六，空数组=不重复
  apps: string[]; // 要屏蔽的应用列表
  mode: 'focus' | 'shield'; // 模式
}
```

**重复规则说明：**

- `[]` - 不重复（定时计划执行一次）
- `[1,2,3,4,5]` - 工作日重复
- `[0,6]` - 周末重复
- `[1,2,3,4,5,6,0]` - 每天重复
- 自定义组合 - 如 `[1,3,5]` 表示周一、周三、周五

#### 2.1.3 计划操作

| 操作     | 说明                           | 触发条件                 |
| -------- | ------------------------------ | ------------------------ |
| 创建计划 | 新建专注计划                   | 用户在计划页面点击添加   |
| 编辑计划 | 修改已有计划                   | 用户点击计划详情         |
| 删除计划 | 移除计划                       | 用户左滑删除或详情页删除 |
| 暂停计划 | 临时暂停当前进行中的计划       | 用户点击暂停按钮         |
| 恢复计划 | 恢复已暂停的计划               | 用户点击继续按钮         |
| 退出计划 | 提前结束当前计划（扣除自律币） | 用户主动退出             |

### 2.2 快速开始（一次性计划入口）

快速启动一次性专注的便捷入口，无需创建计划，适用于临时专注需求。

**功能定位**：

1. **onboarding 阶段**
   - 新用户首次体验：1分钟快速感受系统屏蔽效果
   - 在理解"什么是系统级屏蔽"后，再引导创建定时计划

2. **日常使用场景**
   - 突发会议、临时学习任务
   - 不想创建计划，但需要短暂屏蔽
   - 比创建计划更便捷的快速入口

**产品策略**：

- 建议用户创建定时计划（体现核心价值：自动执行）
- 但临时专注是真实需求，快速开始提供便捷性
- 两者结合：定时计划负责日常自动执行，快速开始处理临时需求

**页面元素**：

- 应用选择器：选择要屏蔽的应用
- 时长滑块：设置专注时长（5-120分钟）
- 开始按钮：立即开始专注

**流程**：

1. 用户点击首页"快速开始"
2. 选择要屏蔽的应用
3. 设置专注时长
4. 点击开始 → 创建一次性计划 → 启动屏蔽

### 2.3 应用屏蔽（iOS 原生）

利用 iOS Screen Time API 实现系统级应用屏蔽。

#### 2.3.1 技术实现

```
┌─────────────────────────────────────┐
│          React Native 层            │
│   选择应用 → 设置时长 → 开始专注    │
└──────────────┬──────────────────────┘
               │
               ▼
┌─────────────────────────────────────┐
│         Native Bridge 层            │
│  startAppLimits() / stopAppLimits() │
└──────────────┬──────────────────────┘
               │
               ▼
┌─────────────────────────────────────┐
│       iOS Family Controls           │
│  • DeviceActivitySchedule           │
│  • ShieldExtension（屏蔽界面）       │
│  • MonitorExtension（活动监控）      │
└─────────────────────────────────────┘
```

#### 2.3.2 权限要求

- **Screen Time 权限**：必需，用于获取应用列表和设置限制
- **Family Controls 授权**：必需，用于创建屏蔽规则

#### 2.3.3 屏蔽效果

当用户尝试打开被屏蔽的应用时：

1. 系统弹出 Shield 界面，阻止应用启动
2. 显示"当前处于专注时间"提示
3. 用户无法绕过（除非主动退出计划）

### 2.4 专注记录与统计

#### 2.4.1 记录数据

```typescript
interface Record {
  id: string;
  plan_id: string;
  title: string;
  start_min: number; // 开始时间
  total_min: number; // 计划时长
  actual_min: number; // 实际完成时长
  status: 'completed' | 'failed' | 'in_progress';
  created_at: string;
}
```

#### 2.4.2 统计指标

| 指标         | 说明                 | 计算方式                   |
| ------------ | -------------------- | -------------------------- |
| 总专注时长   | 累计实际专注分钟数   | `SUM(actual_min)`          |
| 成功率       | 完成计划的比例       | `completed / total * 100%` |
| 平均单次时长 | 每次专注的平均时长   | `AVG(actual_min)`          |
| 连续天数     | 连续有专注记录的天数 | 按日期统计                 |

#### 2.4.3 展示维度

- 今日统计
- 本周统计
- 本月统计
- 历史趋势图（规划中）

### 2.5 用户系统

#### 2.5.1 登录方式

| 方式          | 优先级 | 说明                   |
| ------------- | ------ | ---------------------- |
| Apple Sign-in | P0     | iOS 必需，首选登录方式 |
| 微信登录      | P1     | 国内用户常用           |
| 手机号登录    | P2     | 备选方式               |

#### 2.5.2 用户信息

```typescript
interface UserInfo {
  id: string;
  username: string;
  phone?: string;
  avatar?: string;
  created_at: string;
}
```

### 2.6 权益系统

#### 2.6.1 自律币

虚拟货币，用于激励用户坚持专注。

| 操作         | 自律币变化       |
| ------------ | ---------------- |
| 完成专注计划 | +N（根据时长）   |
| 暂停专注计划 | -1               |
| 提前退出计划 | -N（根据已投入） |
| 每日签到     | +1（规划中）     |

#### 2.6.2 会员权益（规划中）

| 权益         | 免费用户 | VIP 用户 |
| ------------ | -------- | -------- |
| 可屏蔽应用数 | 3 个     | 无限制   |
| 每日专注时长 | 60 分钟  | 无限制   |
| 计划数量     | 3 个     | 无限制   |
| 详细统计报告 | ✗        | ✓        |
| 专属主题     | ✗        | ✓        |

### 2.7 挑战系统（MVP 隐藏）

游戏化功能，提升用户粘性。

#### 2.7.1 挑战类型

```typescript
interface Challenge {
  id: string;
  title: string;
  difficulty: 'easy' | 'normal' | 'hard';
  goal_total_mins: number; // 目标总时长
  goal_once_mins: number; // 单次最低时长
  goal_repeat_times: number; // 需完成次数
  entry_coins: number; // 入场自律币
  reward_apps: number; // 奖励可选应用数
  reward_duration: number; // 奖励专注时长
}
```

#### 2.7.2 挑战流程

1. **领取挑战**：用户支付入场自律币，选择关联计划
2. **进行中**：系统自动追踪进度
3. **完成/失败**：根据结果发放奖励或扣除自律币

---

## 3. 页面结构

### 3.1 导航架构

```
App
├── (tabs)/                    # 底部标签导航
│   ├── index.tsx             # 专注页（首页）
│   ├── record.tsx            # 统计页
│   ├── challenges.tsx        # 挑战页（MVP 隐藏）
│   └── user.tsx              # 我的页
│
├── plans/                     # 计划管理
│   ├── index.tsx             # 计划列表
│   ├── add.tsx               # 新建计划
│   └── item.tsx              # 计划详情
│
├── apps/                      # 应用管理
│   ├── index.tsx             # 应用列表
│   └── add.tsx               # 添加应用
│
├── quick-start/               # 快速开始
│   └── index.tsx             # 快速启动页
│
├── login/                     # 登录认证
│   ├── start.tsx             # 登录引导
│   ├── wx.tsx                # 微信登录
│   └── register.tsx          # 注册
│
├── setting/                   # 设置
│   ├── index.tsx             # 设置主页
│   ├── about.tsx             # 关于我们
│   ├── feedback.tsx          # 意见反馈
│   └── permission.tsx        # 权限管理
│
├── onboarding/                # 新手引导
│   └── index.tsx             # 引导流程
│
└── user/                      # 用户相关
    ├── edit.tsx              # 编辑资料
    ├── vip.tsx               # VIP 页面
    └── coins.tsx             # 自律币
```

### 3.2 核心页面说明

#### 3.2.1 首页（专注页）

**状态1：无进行中的计划**

- 显示下一个计划信息
- 快速开始入口
- 今日专注统计

**状态2：有进行中的计划**

- 显示计时器（倒计时/正计时）
- 暂停/继续按钮
- 退出按钮
- 被屏蔽的应用列表

#### 3.2.2 统计页

- 今日/本周/本月切换
- 专注时长统计
- 成功率展示
- 历史记录列表

#### 3.2.3 我的页

- 用户信息展示
- VIP 入口
- 权限管理
- 意见反馈
- 设置入口

---

## 4. 核心用户流程

### 4.1 新用户引导流程

**引导目标**：
让用户理解产品的两个核心价值：

1. **系统级强制屏蔽** - 通过一次性计划快速体验（1分钟）
2. **自动执行计划** - 引导创建第一个定时计划

**设计逻辑**：

- 先用一次性计划让用户体验"什么是系统级屏蔽"
- 体验后再引导创建定时计划，理解"自动执行"的价值
- 两步递进：体验效果 → 理解价值 → 创建计划

```
启动 App
    │
    ▼
┌─────────────┐
│  欢迎页面    │ ← 产品定位：定时自动屏蔽应用
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  权限预热    │ ← 解释为何需要权限：实现系统级屏蔽
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  请求权限    │ ← Screen Time 权限
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  选择应用    │ ← 选择3个想屏蔽的应用
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  体验专注    │ ← 【一次性计划】1分钟快速体验系统屏蔽效果
└──────┬──────┘     （先体验"什么是强制屏蔽"）
       │
       ▼
┌─────────────┐
│  创建计划    │ ← 【定时计划】引导创建第一个定时计划
└──────┬──────┘     （再理解"自动执行"的价值）
       │
       ▼
┌─────────────┐
│  进入首页    │
└─────────────┘
```

### 4.2 开始专注流程

```
用户点击"快速开始"
    │
    ▼
选择要屏蔽的应用
    │
    ▼
设置专注时长
    │
    ▼
点击"开始专注"
    │
    ├──→ 检查权限
    │       │
    │       ├─ 权限未授予 → 跳转权限设置
    │       │
    │       └─ 权限已授予 ↓
    │
    ▼
创建专注记录
    │
    ▼
调用 iOS API 启动屏蔽
    │
    ▼
返回首页，显示计时器
    │
    ▼
┌─────────────────────────────────┐
│           专注进行中             │
│                                 │
│  • 用户尝试打开被屏蔽应用        │
│    → 显示 Shield 界面           │
│                                 │
│  • 用户点击暂停                  │
│    → 暂停计时，解除屏蔽          │
│    → 扣除1个自律币               │
│                                 │
│  • 用户点击退出                  │
│    → 结束计划，标记为失败        │
│    → 扣除自律币                  │
│                                 │
│  • 时间到                        │
│    → 自动完成，奖励自律币        │
│    → 显示完成弹窗                │
└─────────────────────────────────┘
```

---

## 5. 技术约束

### 5.1 平台限制

| 约束                  | 说明                                 |
| --------------------- | ------------------------------------ |
| 仅支持 iOS            | 应用屏蔽依赖 iOS Family Controls API |
| iOS 16+               | Family Controls API 最低版本要求     |
| 需要 Screen Time 权限 | 核心功能依赖此权限                   |

### 5.2 API 依赖

- 后端 API：`https://focus.ruidoc.cn/dev-api`
- PostHog：数据分析和 A/B 实验
- Stripe：支付集成（规划中）
- 微信 SDK：微信登录

### 5.3 存储策略

| 数据类型 | 存储方式          | 理由                     |
| -------- | ----------------- | ------------------------ |
| 计划数据 | MMKV              | 高频读写，需要快速响应   |
| 用户信息 | AsyncStorage      | 低频访问，需要持久化     |
| Token    | MMKV + App Groups | 主 App 和 Extension 共享 |
| 专注状态 | App Groups        | Extension 需要读取       |

---

## 6. 版本规划

### 6.1 MVP（当前版本）

**核心功能**：

- [x] 专注计划管理（创建/编辑/删除）
- [x] 快速开始一次性专注
- [x] iOS 应用屏蔽（Screen Time）
- [x] 专注记录与基础统计
- [x] 用户登录（Apple/微信/手机号）
- [x] 自律币基础系统
- [x] 新手引导流程

**隐藏功能**：

- [ ] 挑战系统（代码已完成，入口隐藏）
- [ ] VIP 会员系统

### 6.2 V1.1（计划中）

- [ ] 详细统计报告（图表展示）
- [ ] VIP 会员系统上线
- [ ] 应用使用时长统计
- [ ] 小组件支持

### 6.3 V1.2（计划中）

- [ ] 挑战系统正式上线
- [ ] 社交功能（好友排行）
- [ ] 专注白噪音
- [ ] 自定义 Shield 界面

---

## 7. 成功指标

### 7.1 核心指标

| 指标           | 定义                            | 目标  |
| -------------- | ------------------------------- | ----- |
| 日活用户 (DAU) | 每日启动 App 的独立用户数       | -     |
| 专注完成率     | 完成的专注计划 / 开始的专注计划 | > 70% |
| 次日留存率     | 次日回访用户 / 新增用户         | > 40% |
| 7日留存率      | 7日后回访用户 / 新增用户        | > 20% |
| 付费转化率     | 付费用户 / 活跃用户             | > 5%  |

### 7.2 用户行为指标

| 指标         | 定义                     |
| ------------ | ------------------------ |
| 平均专注时长 | 用户每次专注的平均分钟数 |
| 日均专注次数 | 用户每天启动专注的次数   |
| 屏蔽应用数   | 用户选择屏蔽的应用数量   |
| 暂停率       | 暂停次数 / 专注次数      |
| 退出率       | 提前退出次数 / 专注次数  |

---

## 8. 术语统一

为确保产品、技术、用户沟通的一致性，制定以下术语规范：

### 8.1 核心术语对照表

| 中文（用户侧） | 中文（技术侧） | 英文代码 | 使用场景 | 说明 |
|--------------|--------------|---------|---------|------|
| **快速专注** | 一次性计划 | `once` | UI、用户文档、对外文案 | 强调便捷性，适合临时需求 |
| **专注计划** | 定时计划 | `scheduled` | UI、用户文档、对外文案 | 强调规划性和自动执行 |
| （不对外） | 重复规则 | `repeat` | 技术文档、代码 | 定时计划的属性，不单独呈现 |

### 8.2 使用原则

**用户视角（UI/文案）：**
- 使用"快速专注"表示临时性、一次性的专注需求
- 使用"专注计划"表示定时自动执行的计划

**技术视角（代码/文档）：**
- 使用"一次性计划"表示 type='once'
- 使用"定时计划"表示 type='scheduled'
- 使用"重复规则"表示 repeat 属性

**场景区分：**

1. **快速专注（一次性计划）适用于：**
   - onboarding 体验阶段
   - 临时有空想专注
   - 突发需求立即屏蔽
   - 不想创建计划的用户

2. **专注计划（定时计划）适用于：**
   - 每天固定时段需要专注
   - 工作日/周末规律专注
   - 想建立长期习惯
   - 体现产品核心价值（自动执行）

### 8.3 引导策略

产品应明确引导用户创建专注计划，但同时承认快速专注的价值：

**引导文案示例：**
```
需要临时专注？ → 快速专注
想让专注在固定时段自动执行？ → 创建计划

什么时候创建计划？
✓ 每天固定时段需要专注（如工作时间）
✓ 发现某个时段经常分心
✓ 想建立专注习惯

什么时候快速专注？
✓ 临时有空，想专注一下
✓ 突发需求，立即需要屏蔽
```

---

## 9. 相关文档

- [系统架构文档](../ARCHITECTURE.md)
- [增长计划](../growth/plan.md)
- [新手引导方案 A](../onboarding/planA.md)
- [新手引导方案 B](../onboarding/planB.md)
- [Family Controls 配置](../develop/family-controls-setup.md)

---

_文档版本：1.1_
_最后更新：2026-02-02_
